(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory(require("d3")):typeof define==="function"&&define.amd?define(["d3"],factory):(global.d3=global.d3||{},global.d3.x3dom=factory(global.d3))})(this,function(d3){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function dataTransform(data){var SINGLE_SERIES=1;var MULTI_SERIES=2;var dataStructure=data.key!==undefined?SINGLE_SERIES:MULTI_SERIES;var rowKey=function(){if(dataStructure===SINGLE_SERIES){return d3.values(data)[0]}}();var rowKeys=function(){if(dataStructure===MULTI_SERIES){return data.map(function(d){return d.key})}}();var rowTotals=function(){if(MULTI_SERIES===dataStructure){var ret={};d3.map(data).values().forEach(function(d){var rowKey=d.key;d.values.forEach(function(d){ret[rowKey]=typeof ret[rowKey]==="undefined"?0:ret[rowKey];ret[rowKey]+=d.value})});return ret}}();var rowTotalsMax=function(){if(dataStructure===MULTI_SERIES){return d3.max(d3.values(rowTotals))}}();var union=function union(array1,array2){var ret=[];var arr=array1.concat(array2);var len=arr.length;var assoc={};while(len--){var item=arr[len];if(!assoc[item]){ret.unshift(item);assoc[item]=true}}return ret};var columnKeys=function(){if(dataStructure===SINGLE_SERIES){return d3.values(data.values).map(function(d){return d.key})}var ret=[];d3.map(data).values().forEach(function(d){var tmp=[];d.values.forEach(function(d,i){tmp[i]=d.key});ret=union(tmp,ret)});return ret}();var rowTotal=function(){if(dataStructure===SINGLE_SERIES){return d3.sum(data.values,function(d){return d.value})}}();var columnTotals=function(){if(dataStructure!==MULTI_SERIES){return}var ret={};d3.map(data).values().forEach(function(d){d.values.forEach(function(d){var columnName=d.key;ret[columnName]=typeof ret[columnName]==="undefined"?0:ret[columnName];ret[columnName]+=d.value})});return ret}();var columnTotalsMax=function(){if(dataStructure===MULTI_SERIES){return d3.max(d3.values(columnTotals))}}();var minValue=function(){if(dataStructure===SINGLE_SERIES){return d3.min(data.values,function(d){return+d.value})}var ret=void 0;d3.map(data).values().forEach(function(d){d.values.forEach(function(d){ret=typeof ret==="undefined"?d.value:d3.min([ret,+d.value])})});return+ret}();var maxValue=function(){if(dataStructure===SINGLE_SERIES){return d3.max(data.values,function(d){return+d.value})}var ret=void 0;d3.map(data).values().forEach(function(d){d.values.forEach(function(d){ret=typeof ret==="undefined"?d.value:d3.max([ret,+d.value])})});return+ret}();var maxCoordinates=function(){var maxX=void 0,maxY=void 0,maxZ=void 0;if(dataStructure===SINGLE_SERIES){maxX=d3.max(data.values,function(d){return+d.x});maxY=d3.max(data.values,function(d){return+d.y});maxZ=d3.max(data.values,function(d){return+d.z})}else{d3.map(data).values().forEach(function(d){d.values.forEach(function(d){maxX=typeof maxX==="undefined"?d.x:d3.max([maxX,+d.x]);maxY=typeof maxY==="undefined"?d.y:d3.max([maxY,+d.y]);maxZ=typeof maxZ==="undefined"?d.z:d3.max([maxZ,+d.z])})})}return{x:maxX,y:maxY,z:maxZ}}();var decimalPlaces=function decimalPlaces(num){var match=(""+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!match){return 0}return Math.max(0,(match[1]?match[1].length:0)-(match[2]?+match[2]:0))};var maxDecimalPlace=function(){var ret=0;if(dataStructure===MULTI_SERIES){d3.map(data).values().forEach(function(d){d.values.forEach(function(d){ret=d3.max([ret,decimalPlaces(d.value)])})})}return ret>20?20:ret}();var thresholds=function(){var distance=maxValue-minValue;return[+(minValue+.15*distance).toFixed(maxDecimalPlace),+(minValue+.4*distance).toFixed(maxDecimalPlace),+(minValue+.55*distance).toFixed(maxDecimalPlace),+(minValue+.9*distance).toFixed(maxDecimalPlace)]}();var rotate=function rotate(){var columnKeys=data.map(function(d){return d.key});var rowKeys=data[0].values.map(function(d){return d.key});var rotated=rowKeys.map(function(rowKey,rowIndex){var values=columnKeys.map(function(columnKey,columnIndex){var values=_extends({},data[columnIndex].values[rowIndex]);values.key=columnKey;return values});return{key:rowKey,values:values}});return rotated};var summary=function summary(){return{dataStructure:dataStructure,rowKey:rowKey,rowTotal:rowTotal,rowKeys:rowKeys,rowTotals:rowTotals,rowTotalsMax:rowTotalsMax,columnKeys:columnKeys,columnTotals:columnTotals,columnTotalsMax:columnTotalsMax,minValue:minValue,maxValue:maxValue,maxCoordinates:maxCoordinates,maxDecimalPlace:maxDecimalPlace,thresholds:thresholds}};return{summary:summary,rotate:rotate}}function componentAxis(){var dimensions={x:40,y:40,z:40};var color="black";var classed="x3dAxis";var scale=void 0;var dir=void 0;var tickDir=void 0;var tickArguments=[];var tickValues=null;var tickFormat=null;var tickSize=1;var tickPadding=1;var axisDirectionVectors={x:[1,0,0],y:[0,1,0],z:[0,0,1]};var axisRotationVectors={x:[1,1,0,Math.PI],y:[0,0,0,0],z:[0,1,1,Math.PI]};function getAxisDirectionVector(axisDir){return axisDirectionVectors[axisDir]}function getAxisRotationVector(axisDir){return axisRotationVectors[axisDir]}function my(selection){selection.classed(classed,true);var makeSolid=function makeSolid(selection,color){selection.append("appearance").append("material").attr("diffuseColor",color||"black");return selection};var range=scale.range();var range0=range[0];var range1=range[range.length-1];var dirVec=getAxisDirectionVector(dir);var tickDirVec=getAxisDirectionVector(tickDir);var rotVec=getAxisRotationVector(dir);var tickRotVec=getAxisRotationVector(tickDir);var path=selection.selectAll("transform").data([null]);var tickValuesDefault=scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain();tickValues=tickValues===null?tickValuesDefault:tickValues;var tick=selection.selectAll(".tick").data(tickValues,scale).order();var tickExit=tick.exit();var tickEnter=tick.enter().append("transform").attr("translation",function(t){return dirVec.map(function(a){return scale(t)*a}).join(" ")}).attr("class","tick");var line=tick.select(".tickLine");path=path.merge(path.enter().append("transform").attr("rotation",rotVec.join(" ")).attr("translation",dirVec.map(function(d){return d*(range0+range1)/2}).join(" ")).append("shape").call(makeSolid,color).attr("class","domain"));tick=tick.merge(tickEnter);line=line.merge(tickEnter.append("transform"));var tickFormatDefault=scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):function(d){return d};tickFormat=tickFormat===null?tickFormatDefault:tickFormat;if(tickFormat!==""){var text=tick.select("billboard");var newText=tickEnter.append("transform");newText.attr("translation",tickDirVec.map(function(d){return-d*tickPadding})).append("billboard").attr("axisOfRotation","0 0 0").append("shape").call(makeSolid,"black").append("text").attr("string",tickFormat).append("fontstyle").attr("size",1.3).attr("family","SANS").attr("style","BOLD").attr("justify","MIDDLE");text=text.merge(newText)}tickExit.remove();path.append("cylinder").attr("radius",.1).attr("height",range1-range0);line.attr("translation",tickDirVec.map(function(d){return d*tickSize/2}).join(" ")).attr("rotation",tickRotVec.join(" ")).attr("class","tickLine").append("shape").call(makeSolid).append("cylinder").attr("radius",.05).attr("height",tickSize)}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.scale=function(value){if(!arguments.length)return scale;scale=value;return my};my.color=function(value){if(!arguments.length)return color;color=value;return my};my.dir=function(value){return arguments.length?(dir=value,my):dir};my.tickDir=function(value){return arguments.length?(tickDir=value,my):tickDir};var slice=Array.prototype.slice;my.ticks=function(){return tickArguments=slice.call(arguments),my};my.tickArguments=function(value){return arguments.length?(tickArguments=value===null?[]:slice.call(value),my):tickArguments.slice()};my.tickValues=function(value){return arguments.length?(tickValues=value===null?null:slice.call(value),my):tickValues&&tickValues.slice()};my.tickFormat=function(value){return arguments.length?(tickFormat=value,my):tickFormat};my.tickSize=function(value){return arguments.length?(tickSize=+value,my):tickSize};my.tickPadding=function(value){return arguments.length?(tickPadding=+value,my):tickPadding};return my}function axisThreePlane(){var dimensions={x:40,y:40,z:40};var colors=["blue","red","green"];var classed="x3dAxisThreePlane";var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;function my(selection){var layers=["xzAxis","yzAxis","yxAxis","zxAxis"];selection.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var xzAxis=componentAxis().scale(xScale).dir("x").tickDir("z").tickSize(zScale.range()[1]-zScale.range()[0]).tickPadding(xScale.range()[0]).color("blue");var yzAxis=componentAxis().scale(yScale).dir("y").tickDir("z").tickSize(zScale.range()[1]-zScale.range()[0]).color("red");var yxAxis=componentAxis().scale(yScale).dir("y").tickDir("x").tickSize(xScale.range()[1]-xScale.range()[0]).tickFormat("").color("red");var zxAxis=componentAxis().scale(zScale).dir("z").tickDir("x").tickSize(xScale.range()[1]-xScale.range()[0]).color("black");selection.select(".xzAxis").call(xzAxis);selection.select(".yzAxis").call(yzAxis);selection.select(".yxAxis").call(yxAxis);selection.select(".zxAxis").call(zxAxis)}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};return my}function componentBars(){var dimensions={x:40,y:40,z:2};var colors=["orange","red","yellow","steelblue","green"];var classed="x3dBars";var xScale=void 0;var yScale=void 0;var colorScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(seriesNames).range(colors):colorScale;xScale=typeof xScale==="undefined"?d3.scaleBand().domain(seriesNames).rangeRound([0,dimensions.x]).padding(.3):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]):yScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var bars=selection.selectAll(".bar").data(function(d){return d.values});var barsEnter=bars.enter().append("transform").classed("bar",true).attr("scale",function(d){var x=xScale.bandwidth();var y=yScale(d.value);var z=dimensions.z;return x+" "+y+" "+z}).attr("translation",function(d){var x=xScale(d.key);var y=yScale(d.value)/2;var z=0;return x+" "+y+" "+z}).append("shape").merge(bars);barsEnter.append("box").attr("size","1.0 1.0 1.0");barsEnter.append("appearance").append("material").attr("diffuseColor",function(d){return colorScale(d.key)}).attr("ambientIntensity","0.1");bars.transition().attr("scale",function(d){var x=xScale.bandwidth();var y=yScale(d.value);var z=dimensions.z;return x+" "+y+" "+z}).attr("translation",function(d){var x=xScale(d.key);var y=yScale(d.value)/2;var z=0;return x+" "+y+" "+z})})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};return my}function barsMultiSeries(){var dimensions={x:40,y:40,z:40};var colors=["orange","red","yellow","steelblue","green"];var classed="x3dBarsMultiSeries";var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var categoryNames=dataSummary.rowKeys;var seriesNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(seriesNames).range(colors):colorScale;xScale=typeof xScale==="undefined"?d3.scaleBand().domain(seriesNames).rangeRound([0,dimensions.x]).padding(.5):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scaleBand().domain(categoryNames).range([0,dimensions.z]).padding(.7):zScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var bars=componentBars().xScale(xScale).yScale(yScale).dimensions({x:dimensions.x,y:dimensions.y,z:zScale.bandwidth()}).colors(colors);var barGroup=selection.selectAll(".barGroup").data(data);barGroup.enter().append("transform").classed("barGroup",true).attr("translation",function(d){var x=0;var y=0;var z=zScale(d.key);return x+" "+y+" "+z}).append("group").call(bars).merge(barGroup);barGroup.exit().remove()})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};return my}function componentBubbles(){var dimensions={x:40,y:40,z:40};var color="orange";var classed="x3dBubbles";var xScale=void 0;var yScale=void 0;var zScale=void 0;var sizeScale=void 0;var sizeDomain=[.5,4];function init(data){var maxX=d3.max(data.values,function(d){return+d.x});var maxY=d3.max(data.values,function(d){return+d.y});var maxZ=d3.max(data.values,function(d){return+d.z});var maxValue=d3.max(data.values,function(d){return+d.value});xScale=typeof xScale==="undefined"?d3.scaleLinear().domain([0,maxX]).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxY]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scaleLinear().domain([0,maxZ]).range([0,dimensions.z]):zScale;sizeScale=typeof sizeScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range(sizeDomain):sizeScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var makeSolid=function makeSolid(selection,color){selection.append("appearance").append("material").attr("diffuseColor",color||"black");return selection};var bubblesSelect=selection.selectAll(".point").data(function(d){return d.values});var bubbles=bubblesSelect.enter().append("transform").attr("class","point").attr("translation",function(d){return xScale(d.x)+" "+yScale(d.y)+" "+zScale(d.z)}).attr("onmouseover","d3.select(this).select('billboard').attr('render', true);").attr("onmouseout","d3.select(this).select('transform').select('billboard').attr('render', false);").merge(bubblesSelect);bubbles.append("shape").call(makeSolid,color).append("sphere").attr("radius",function(d){return sizeScale(d.value)});bubbles.append("transform").attr("translation","0.8 0.8 0.8").append("billboard").attr("render",false).attr("axisOfRotation","0 0 0").append("shape").call(makeSolid,"blue").append("text").attr("class","labelText").attr("string",function(d){return d.key}).append("fontstyle").attr("size",1).attr("family","SANS").attr("style","BOLD").attr("justify","START").attr("render",false)})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.sizeScale=function(value){if(!arguments.length)return sizeScale;sizeScale=value;return my};my.sizeDomain=function(value){if(!arguments.length)return sizeDomain;sizeDomain=value;return my};my.color=function(value){if(!arguments.length)return color;color=value;return this};return my}function bubblesMultiSeries(){var dimensions={x:40,y:40,z:40};var colors=["green","red","yellow","steelblue","orange"];var classed="x3dBubblesMultiSeries";var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;var sizeScale=void 0;var sizeDomain=[.5,4];function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.rowKeys;var maxCoordinates=dataSummary.maxCoordinates;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(seriesNames).range(colors):colorScale;xScale=typeof xScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.x]).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.y]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.z]).range([0,dimensions.z]):zScale;sizeScale=typeof sizeScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([.5,3]):sizeScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var bubbles=componentBubbles().xScale(xScale).yScale(yScale).zScale(zScale).sizeScale(sizeScale).color(function(d){return colorScale(d.key)});var bubbleGroup=selection.selectAll(".bubbleGroup").data(data);bubbleGroup.enter().append("group").classed("bubbleGroup",true).each(function(d){var color=colorScale(d.key);bubbles.color(color);d3.select(this).call(bubbles)}).merge(bubbleGroup);bubbleGroup.exit().remove()})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.sizeScale=function(value){if(!arguments.length)return sizeScale;sizeScale=value;return my};my.sizeDomain=function(value){if(!arguments.length)return sizeDomain;sizeDomain=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};return my}function surfaceArea(){var dimensions={x:40,y:40,z:40};var colors=["blue","red"];var classed="x3dSurfaceArea";var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;function array2dToString(arr){return arr.reduce(function(a,b){return a.concat(b)},[]).reduce(function(a,b){return a.concat(b)},[]).join(" ")}function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.rowKeys;var groupNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range(colors).interpolate(d3.interpolateLab):colorScale;xScale=typeof xScale==="undefined"?d3.scalePoint().domain(seriesNames).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scalePoint().domain(groupNames).range([0,dimensions.z]):zScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var ny=data.length;var nx=data[0].values.length;var coordinatePoints=function coordinatePoints(data){var points=data.map(function(X){return X.values.map(function(d){return[xScale(X.key),yScale(d.value),zScale(d.key)]})});return array2dToString(points)};var colorFaceSet=function colorFaceSet(data){var colors=data.map(function(X){return X.values.map(function(d){var col=d3.color(colorScale(d.value));return""+Math.round(col.r/2.55)/100+" "+Math.round(col.g/2.55)/100+" "+Math.round(col.b/2.55)/100})});return array2dToString(colors)};var coordIndex=Array.apply(0,Array(ny-1)).map(function(_,j){return Array.apply(0,Array(nx-1)).map(function(_,i){var start=i+j*nx;return[start,start+nx,start+nx+1,start+1,start,-1]})});var coordIndexBack=Array.apply(0,Array(ny-1)).map(function(_,j){return Array.apply(0,Array(nx-1)).map(function(_,i){var start=i+j*nx;return[start,start+1,start+nx+1,start+nx,start,-1]})});var coords=array2dToString(coordIndex.concat(coordIndexBack));var surfaces=selection.selectAll(".surface").data([data]);var indexedfaceset=surfaces.enter().append("shape").append("indexedfaceset").attr("coordIndex",coords);indexedfaceset.append("coordinate").attr("point",coordinatePoints);indexedfaceset.append("color").attr("color",colorFaceSet)})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};return my}function viewpoint(){var centerOfRotation=[0,0,0];var viewPosition=[80,15,80];var viewOrientation=[0,1,0,.8];var fieldOfView=.8;var classed="x3dViewpoint";function my(selection){selection.append("viewpoint").classed(classed,true).attr("centerOfRotation",centerOfRotation.join(" ")).attr("position",viewPosition.join(" ")).attr("orientation",viewOrientation.join(" ")).attr("fieldOfView",fieldOfView).attr("set_bind","true")}my.quickView=function(view){switch(view){case"left":centerOfRotation=[0,0,0];viewPosition=[37.10119,18.70484,51.01594];viewOrientation=[.06724,.99767,-.01148,.33908];fieldOfView=1;break;case"side":centerOfRotation=[20,0,0];viewPosition=[20,20,50];viewOrientation=[0,0,0,0];fieldOfView=1;break;case"top":centerOfRotation=[0,0,0];viewPosition=[27.12955,106.67181,31.65828];viewOrientation=[-.86241,.3749,.34013,1.60141];fieldOfView=1;break;case"dimetric":default:centerOfRotation=[0,0,0];viewPosition=[80,15,80];viewOrientation=[0,1,0,.8];fieldOfView=.8}return my};my.centerOfRotation=function(value){if(!arguments.length)return centerOfRotation;centerOfRotation=value;return my};my.viewPosition=function(value){if(!arguments.length)return viewPosition;viewPosition=value;return my};my.viewOrientation=function(value){if(!arguments.length)return viewOrientation;viewOrientation=value;return my};my.fieldOfView=function(value){if(!arguments.length)return fieldOfView;fieldOfView=value;return my};return my}function ribbon(){var dimensions={x:40,y:40,z:40};var color="red";var classed="x3dRibbon";var xScale=void 0;var yScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;xScale=typeof xScale==="undefined"?d3.scaleBand().domain(seriesNames).rangeRound([0,dimensions.x]).padding(.3):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]):yScale}function my(selection){selection.classed(classed,true);selection.each(function(data){init(data);var ribbonSelect=selection.selectAll(".point").data(function(d){return d.values});var ribbon=ribbonSelect.enter().append("transform").attr("translation",function(d){var x=xScale(d.key);var y=yScale(d.value)/2;return x+" "+y+" 0"}).attr("rotation",function(){return"0,-1,0,1.57079633"}).append("shape");ribbon.append("rectangle2d").attr("size",function(d){var width=5;var height=yScale(d.value);return width+" "+height}).attr("solid","true");ribbon.append("appearance").append("twosidedmaterial").attr("diffuseColor",color)})}my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.color=function(value){if(!arguments.length)return color;color=value;return this};return my}var component={axis:componentAxis,axisThreePlane:axisThreePlane,bars:componentBars,barsMultiSeries:barsMultiSeries,bubbles:componentBubbles,bubblesMultiSeries:bubblesMultiSeries,surfaceArea:surfaceArea,viewpoint:viewpoint,ribbon:ribbon};function surfaceArea$1(){var width=500;var height=500;var dimensions={x:40,y:40,z:40};var colors=["blue","red"];var classed="x3dSurfaceArea";var debug=false;var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.rowKeys;var groupNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;var extent=[0,maxValue];colorScale=typeof colorScale==="undefined"?d3.scaleLinear().domain(extent).range(colors).interpolate(d3.interpolateLab):colorScale;xScale=typeof xScale==="undefined"?d3.scalePoint().domain(seriesNames).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain(extent).range([0,dimensions.y]).nice():yScale;zScale=typeof zScale==="undefined"?d3.scalePoint().domain(groupNames).range([0,dimensions.z]):zScale}function my(selection){var x3d=selection.append("x3d").attr("width",width+"px").attr("height",height+"px");if(debug){x3d.attr("showLog","true").attr("showStat","true")}var scene=x3d.append("scene");var layers=["axis","chart"];scene.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var viewpoint=component.viewpoint().centerOfRotation([dimensions.x/2,dimensions.y/2,dimensions.z/2]);scene.call(viewpoint);scene.each(function(data){init(data);var axis=component.axisThreePlane().xScale(xScale).yScale(yScale).zScale(zScale);var chart=component.surfaceArea().xScale(xScale).yScale(yScale).zScale(zScale).colors(colors);scene.select(".axis").call(axis);scene.select(".chart").datum(data).call(chart)})}my.width=function(value){if(!arguments.length)return width;width=value;return this};my.height=function(value){if(!arguments.length)return height;height=value;return this};my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};my.debug=function(value){if(!arguments.length)return debug;debug=value;return my};return my}var version="1.0.15";var license="GPL-2.0";function barChartMultiSeries(){var width=500;var height=500;var dimensions={x:40,y:40,z:40};var colors=["green","red","yellow","steelblue","orange"];var classed="x3dBarChartMultiSeries";var debug=false;var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var categoryNames=dataSummary.rowKeys;var seriesNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(seriesNames).range(colors):colorScale;xScale=typeof xScale==="undefined"?d3.scaleBand().domain(seriesNames).rangeRound([0,dimensions.x]).padding(.5):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]).nice():yScale;zScale=typeof zScale==="undefined"?d3.scaleBand().domain(categoryNames).range([0,dimensions.z]).padding(.7):zScale}function my(selection){var x3d=selection.append("x3d").attr("width",width+"px").attr("height",height+"px");if(debug){x3d.attr("showLog","true").attr("showStat","true")}var scene=x3d.append("scene");var layers=["axis","chart"];scene.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var viewpoint=component.viewpoint().centerOfRotation([dimensions.x/2,dimensions.y/2,dimensions.z/2]);scene.call(viewpoint);scene.append("directionallight").attr("direction","1 0 -1").attr("on","true").attr("intensity","0.4").attr("shadowintensity","0");scene.each(function(data){init(data);var axis=component.axisThreePlane().xScale(xScale).yScale(yScale).zScale(zScale);var chart=component.barsMultiSeries().xScale(xScale).yScale(yScale).zScale(zScale).colors(colors);scene.select(".axis").call(axis);scene.select(".chart").datum(data).call(chart)})}my.width=function(value){if(!arguments.length)return width;width=value;return this};my.height=function(value){if(!arguments.length)return height;height=value;return this};my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};my.debug=function(value){if(!arguments.length)return debug;debug=value;return my};return my}function barChartVertical(){var width=500;var height=500;var dimensions={x:40,y:40,z:40};var colors=["green","red","yellow","steelblue","orange"];var classed="x3dBarChartVertical";var debug=false;var xScale=void 0;var yScale=void 0;var colorScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var categoryNames=dataSummary.columnKeys;var maxValue=dataSummary.maxValue;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(categoryNames).range(colors):colorScale;xScale=typeof xScale==="undefined"?d3.scaleBand().domain(categoryNames).rangeRound([0,dimensions.x]).padding(.5):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range([0,dimensions.y]).nice():yScale}function my(selection){var x3d=selection.append("x3d").attr("width",width+"px").attr("height",height+"px");if(debug){x3d.attr("showLog","true").attr("showStat","true")}var scene=x3d.append("scene");var layers=["xAxis","yAxis","chart"];scene.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var viewpoint=component.viewpoint().quickView("left");scene.call(viewpoint);scene.each(function(data){init(data);var xAxis=component.axis().scale(xScale).dir("x").tickDir("y");var yAxis=component.axis().scale(yScale).dir("y").tickDir("x").tickSize(yScale.range()[1]-yScale.range()[0]);var chart=component.bars().xScale(xScale).yScale(yScale).colors(colors);scene.select(".xAxis").call(xAxis);scene.select(".yAxis").call(yAxis);scene.select(".chart").datum(data).call(chart)})}my.width=function(value){if(!arguments.length)return width;width=value;return this};my.height=function(value){if(!arguments.length)return height;height=value;return this};my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};my.debug=function(value){if(!arguments.length)return debug;debug=value;return my};return my}function bubbleChart(){var width=500;var height=500;var dimensions={x:40,y:40,z:40};var colors=["green","red","yellow","steelblue","orange"];var classed="x3dBubbleChart";var debug=false;var xScale=void 0;var yScale=void 0;var zScale=void 0;var colorScale=void 0;var sizeScale=void 0;var sizeDomain=[.5,4];function init(data){var dataSummary=dataTransform(data).summary();var seriesNames=dataSummary.rowKeys;var maxCoordinates=dataSummary.maxCoordinates;var maxValue=dataSummary.maxValue;xScale=typeof xScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.x]).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.y]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.z]).range([0,dimensions.z]):zScale;colorScale=typeof colorScale==="undefined"?d3.scaleOrdinal().domain(seriesNames).range(colors):colorScale;sizeScale=typeof sizeScale==="undefined"?d3.scaleLinear().domain([0,maxValue]).range(sizeDomain):sizeScale}function my(selection){var x3d=selection.append("x3d").attr("width",width+"px").attr("height",height+"px");if(debug){x3d.attr("showLog","true").attr("showStat","true")}var scene=x3d.append("scene");var layers=["axis","chart"];scene.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var viewpoint=component.viewpoint().centerOfRotation([dimensions.x/2,dimensions.y/2,dimensions.z/2]);scene.call(viewpoint);scene.append("directionallight").attr("direction","1 0 -1").attr("on","true").attr("intensity","0.4").attr("shadowintensity","0");scene.each(function(data){init(data);var axis=component.axisThreePlane().xScale(xScale).yScale(yScale).zScale(zScale);var chart=component.bubblesMultiSeries().xScale(xScale).yScale(yScale).zScale(zScale).sizeScale(sizeScale).colorScale(colorScale);scene.select(".axis").call(axis);scene.select(".chart").datum(data).call(chart)})}my.width=function(value){if(!arguments.length)return width;width=value;return this};my.height=function(value){if(!arguments.length)return height;height=value;return this};my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.colorScale=function(value){if(!arguments.length)return colorScale;colorScale=value;return my};my.colors=function(value){if(!arguments.length)return colors;colors=value;return my};my.sizeScale=function(value){if(!arguments.length)return sizeScale;sizeScale=value;return my};my.sizeDomain=function(value){if(!arguments.length)return sizeDomain;sizeDomain=value;return my};my.debug=function(value){if(!arguments.length)return debug;debug=value;return my};return my}function scatterPlot(){var width=500;var height=500;var dimensions={x:40,y:40,z:40};var color="orange";var classed="x3dScatterPlot";var debug=false;var xScale=void 0;var yScale=void 0;var zScale=void 0;function init(data){var dataSummary=dataTransform(data).summary();var maxCoordinates=dataSummary.maxCoordinates;xScale=typeof xScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.x]).range([0,dimensions.x]):xScale;yScale=typeof yScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.y]).range([0,dimensions.y]):yScale;zScale=typeof zScale==="undefined"?d3.scaleLinear().domain([0,maxCoordinates.z]).range([0,dimensions.z]):zScale}function my(selection){var x3d=selection.append("x3d").attr("width",width+"px").attr("height",height+"px");if(debug){x3d.attr("showLog","true").attr("showStat","true")}var scene=x3d.append("scene");var layers=["axis","chart"];scene.classed(classed,true).selectAll("group").data(layers).enter().append("group").attr("class",function(d){return d});var viewpoint=component.viewpoint().centerOfRotation([dimensions.x/2,dimensions.y/2,dimensions.z/2]);scene.call(viewpoint);scene.each(function(data){init(data);var axis=component.axisThreePlane().xScale(xScale).yScale(yScale).zScale(zScale);var chart=component.bubbles().xScale(xScale).yScale(yScale).zScale(zScale).color(color).sizeDomain([.5,.5]);scene.select(".axis").call(axis);scene.select(".chart").datum(data).call(chart)})}my.width=function(value){if(!arguments.length)return width;width=value;return this};my.height=function(value){if(!arguments.length)return height;height=value;return this};my.dimensions=function(value){if(!arguments.length)return dimensions;dimensions=value;return this};my.xScale=function(value){if(!arguments.length)return xScale;xScale=value;return my};my.yScale=function(value){if(!arguments.length)return yScale;yScale=value;return my};my.zScale=function(value){if(!arguments.length)return zScale;zScale=value;return my};my.color=function(value){if(!arguments.length)return color;color=value;return my};my.debug=function(value){if(!arguments.length)return debug;debug=value;return my};return my}var chart={barChartMultiSeries:barChartMultiSeries,barChartVertical:barChartVertical,bubbleChart:bubbleChart,scatterPlot:scatterPlot,surfaceArea:surfaceArea$1};var author$1="James Saunders";var date=new Date;var copyright="Copyright (C) "+date.getFullYear()+" "+author$1;var index={version:version,author:author$1,copyright:copyright,license:license,dataTransform:dataTransform,chart:chart,component:component};return index});
