!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):(n.d3=n.d3||{},n.d3.x3dom=e(n.d3))}(this,function(j){"use strict";var A=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};function K(a){var e,t,r,i,o,c,l=["x","y","z"],n=void 0!==a.key?1:2,u=function(){if(1===n)return j.values(a)[0]}(),s=function(){if(1===n)return j.sum(a.values,function(n){return n.value})}(),d=function(){if(2===n)return a.map(function(n){return n.key})}(),f=function(){if(2===n){var t={};return j.map(a).values().forEach(function(n){var e=n.key;n.values.forEach(function(n){t[e]=void 0===t[e]?0:t[e],t[e]+=n.value})}),t}}(),v=function(){if(2===n)return j.max(j.values(f))}(),h=1===n?Object.keys(a.values[0]):Object.keys(a[0].values[0]),g=function(){if(1===n)return j.values(a.values).map(function(n){return n.key});var e=[];return j.map(a).values().forEach(function(n){var t=[];n.values.forEach(function(n,e){t[e]=n.key}),e=function(n,e){for(var t=[],r=n.concat(e),a=r.length,i={};a--;){var o=r[a];i[o]||(t.unshift(o),i[o]=!0)}return t}(t,e)}),e}(),p=function(){if(2===n){var t={};return j.map(a).values().forEach(function(n){n.values.forEach(function(n){var e=n.key;t[e]=void 0===t[e]?0:t[e],t[e]+=n.value})}),t}}(),y=function(){if(2===n)return j.max(j.values(p))}(),x=function(){if(1===n)return j.min(a.values,function(n){return+n.value});var e=void 0;return j.map(a).values().forEach(function(n){n.values.forEach(function(n){e=void 0===e?n.value:j.min([e,+n.value])})}),+e}(),m=(e=void 0,1===n?e=j.max(a.values,function(n){return+n.value}):j.map(a).values().forEach(function(n){n.values.forEach(function(n){e=void 0!==e?j.max([e,+n.value]):+n.value})}),e),S=[x,m],z=(t={},1===n?l.forEach(function(e){t[e]=j.min(a.values,function(n){return+n[e]})}):j.map(a).values().forEach(function(n){n.values.forEach(function(e){l.forEach(function(n){t[n]=n in t?j.min([t[n],+e[n]]):e[n]})})}),t),b=(r={},1===n?l.forEach(function(e){r[e]=j.max(a.values,function(n){return+n[e]})}):j.map(a).values().forEach(function(n){n.values.forEach(function(e){l.forEach(function(n){r[n]=n in r?j.max([r[n],+e[n]]):e[n]})})}),r),k=(i={},l.forEach(function(n){i[n]=[z[n],b[n]]}),i),w=(o=0,2===n&&j.map(a).values().forEach(function(n){n.values.forEach(function(n){var e,t;o=j.max([o,(e=n.value,t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/),t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0)])})}),20<o?20:o),L=(c=m-x,[.15,.4,.55,.9].map(function(n){return Number((x+n*c).toFixed(w))}));return{summary:function(){return{dataType:n,rowKey:u,rowTotal:s,rowKeys:d,rowTotals:f,rowTotalsMax:v,rowValuesKeys:h,columnKeys:g,columnTotals:p,columnTotalsMax:y,valueMin:x,valueMax:m,valueExtent:S,coordinatesMin:z,coordinatesMax:b,coordinatesExtent:k,maxDecimalPlace:w,thresholds:L}},rotate:function(){var e=a.map(function(n){return n.key});return a[0].values.map(function(n){return n.key}).map(function(n,r){return{key:n,values:e.map(function(n,e){var t=A({},a[e].values[r]);return t.key=n,t})}})}}}function l(){var e={x:40,y:40,z:40},x="black",m=void 0,S=void 0,z=void 0,b=[],k=null,w=null,L=1,A=1,t={x:[1,0,0],y:[0,1,0],z:[0,0,1]},r={x:[1,1,0,Math.PI],y:[0,0,0,0],z:[0,1,1,Math.PI]},M=function(n){return t[n]},P=function(n){return r[n]},a=function(n){n.classed("x3dAxis",!0);var e=function(n,e){return n.append("appearance").append("material").attr("diffuseColor",e||"black"),n},t=m.range(),r=t[0],a=t[t.length-1],i=M(S),o=M(z),c=P(S),l=P(z),u=n.selectAll("transform").data([null]),s=m.ticks?m.ticks.apply(m,b):m.domain();k=null===k?s:k;var d=n.selectAll(".tick").data(k,m).order(),f=d.exit(),v=d.enter().append("transform").attr("translation",function(e){return i.map(function(n){return m(e)*n}).join(" ")}).attr("class","tick"),h=d.select(".tickLine");u=u.merge(u.enter().append("transform").attr("rotation",c.join(" ")).attr("translation",i.map(function(n){return n*(r+a)/2}).join(" ")).append("shape").call(e,x).attr("class","domain")),d=d.merge(v),h=h.merge(v.append("transform"));var g=m.tickFormat?m.tickFormat.apply(m,b):function(n){return n};if(""!==(w=null===w?g:w)){var p=d.select("billboard"),y=v.append("transform");y.attr("translation",o.map(function(n){return-n*A})).append("billboard").attr("axisofrotation","0 0 0").append("shape").call(e,"black").append("text").attr("string",w).append("fontstyle").attr("size",1.3).attr("family","SANS").attr("style","BOLD").attr("justify","MIDDLE"),p=p.merge(y)}f.remove(),u.append("cylinder").attr("radius",.1).attr("height",a-r),h.attr("translation",o.map(function(n){return n*L/2}).join(" ")).attr("rotation",l.join(" ")).attr("class","tickLine").append("shape").call(e,"#d3d3d3").append("cylinder").attr("radius",.05).attr("height",L)};return a.dimensions=function(n){return arguments.length?(e=n,a):e},a.scale=function(n){return arguments.length?(m=n,a):m},a.direction=function(n){return arguments.length?(S=n,a):S},a.tickDirection=function(n){return arguments.length?(z=n,a):z},a.tickArguments=function(n){return arguments.length?(b=n,a):b},a.tickValues=function(n){return arguments.length?(k=n,a):k},a.tickFormat=function(n){return arguments.length?(w=n,a):w},a.tickSize=function(n){return arguments.length?(L=n,a):L},a.tickPadding=function(n){return arguments.length?(A=n,a):A},a.color=function(n){return arguments.length?(x=n,a):x},a}function x(){var s={x:40,y:40,z:2},d=["orange","red","yellow","steelblue","green"],f=void 0,v=void 0,h=void 0,e=function(u){u.classed("x3dBars",!0),u.each(function(n){var e,t,r,a,i,o;e=K(n).summary(),t=e.columnKeys,r=[0,e.valueMax],i=(a=s).x,o=a.y,void 0===f&&(f=j.scaleBand().domain(t).rangeRound([0,i]).padding(.3)),void 0===v&&(v=j.scaleLinear().domain(r).range([0,o])),void 0===h&&(h=j.scaleOrdinal().domain(t).range(d));var c=u.selectAll(".bar").data(function(n){return n.values}),l=c.enter().append("transform").classed("bar",!0).attr("scale",function(n){return f.bandwidth()+" "+v(n.value)+" "+s.z}).attr("translation",function(n){return f(n.key)+" "+v(n.value)/2+" 0"}).append("shape");l.append("box").attr("size","1.0 1.0 1.0"),l.append("appearance").append("material").attr("diffusecolor",function(n){return h(n.key)}).attr("ambientintensity","0.1"),l.merge(c),c.transition().attr("scale",function(n){return f.bandwidth()+" "+v(n.value)+" "+s.z}).attr("translation",function(n){return f(n.key)+" "+v(n.value)/2+" 0"}),c.exit().remove()})};return e.dimensions=function(n){return arguments.length?(s=n,this):s},e.xScale=function(n){return arguments.length?(f=n,e):f},e.yScale=function(n){return arguments.length?(v=n,e):v},e.colorScale=function(n){return arguments.length?(h=n,e):h},e.colors=function(n){return arguments.length?(d=n,e):d},e}function k(){var g={x:40,y:40,z:40},p="orange",y=void 0,x=void 0,m=void 0,S=void 0,z=[.5,4],e=function(h){h.classed("x3dBubbles",!0),h.each(function(n){var e,t,r,a,i,o,c,l,u,s;e=K(n).summary(),t=e.valueExtent,r=e.coordinatesMax,a=r.x,i=r.y,o=r.z,l=(c=g).x,u=c.y,s=c.z,void 0===y&&(y=j.scaleLinear().domain([0,a]).range([0,l])),void 0===x&&(x=j.scaleLinear().domain([0,i]).range([0,u])),void 0===m&&(m=j.scaleLinear().domain([0,o]).range([0,s])),void 0===S&&(S=j.scaleLinear().domain(t).range(z));var d=function(n,e){return n.append("appearance").append("material").attr("diffuseColor",e||"black"),n},f=h.selectAll(".bubble").data(function(n){return n.values}),v=f.enter().append("transform").attr("class","bubble").attr("translation",function(n){return y(n.x)+" "+x(n.y)+" "+m(n.z)}).attr("onmouseover","d3.select(this).select('billboard').attr('render', true);").attr("onmouseout","d3.select(this).select('transform').select('billboard').attr('render', false);");v.append("shape").call(d,p).append("sphere").attr("radius",function(n){return S(n.value)}),v.append("transform").attr("translation",function(n){var e=S(n.value)+.8;return e+" "+e+" "+e}).append("billboard").attr("render",!1).attr("axisofrotation","0 0 0").append("shape").call(d,"blue").append("text").attr("class","labelText").attr("string",function(n){return n.key}).append("fontstyle").attr("size",1).attr("family","SANS").attr("style","BOLD").attr("justify","START").attr("render",!1),v.merge(f),f.transition().attr("translation",function(n){return y(n.x)+" "+x(n.y)+" "+m(n.z)}),f.exit().remove()})};return e.dimensions=function(n){return arguments.length?(g=n,this):g},e.xScale=function(n){return arguments.length?(y=n,e):y},e.yScale=function(n){return arguments.length?(x=n,e):x},e.zScale=function(n){return arguments.length?(m=n,e):m},e.sizeScale=function(n){return arguments.length?(S=n,e):S},e.sizeDomain=function(n){return arguments.length?(z=n,e):z},e.color=function(n){return arguments.length?(p=n,e):p},e}function m(){var h={x:40,y:40,z:5},g="red",p=void 0,y=void 0,e=function(u){u.classed("x3dRibbon",!0),u.each(function(n){var e,t,r,a,i,o;e=K(n).summary(),t=e.columnKeys,r=[0,e.valueMax],i=(a=h).x,o=a.y,void 0===p&&(p=j.scalePoint().domain(t).range([0,i])),void 0===y&&(y=j.scaleLinear().domain(r).range([0,o]));var c=u.selectAll(".ribbon").data(function(n){return n.values.map(function(n,e,t){var r=e+1;if(r>=t.length)return null;var a,i,o=t[r],c=p(n.key),l=p(o.key),u=y(n.value),s=y(o.value),d=1-h.z/2,f=h.z/2,v=[[c,u,d],[c,u,f],[l,s,f],[l,s,d],[c,u,d]];return{key:n.key,value:n.value,color:g,transparency:.2,coordindex:(i=v,i.map(function(n,e){return e}).join(" ").concat(" -1")),point:(a=v,a.reduce(function(n,e){return n.concat(e)},[]).reduce(function(n,e){return n.concat(e)},[]).join(" "))}}).filter(function(n){return null!==n})}),l=c.enter().append("shape").classed("ribbon",!0);l.append("indexedfaceset").attr("coordindex",function(n){return n.coordindex}).attr("solid",!0).append("coordinate").attr("point",function(n){return n.point}),l.append("appearance").append("twosidedmaterial").attr("diffusecolor",function(n){return n.color}).attr("transparency",function(n){return n.transparency}),l.merge(c),c.transition().select("indexedfaceset").attr("coordindex",function(n){return n.coordindex}).select("coordinate").attr("point",function(n){return n.point}),c.exit().remove()})};return e.dimensions=function(n){return arguments.length?(h=n,this):h},e.xScale=function(n){return arguments.length?(p=n,e):p},e.yScale=function(n){return arguments.length?(y=n,e):y},e.color=function(n){return arguments.length?(g=n,e):g},e}var O={axis:l,axisThreePlane:function(){var e={x:40,y:40,z:40},t=["blue","red","green"],i=void 0,o=void 0,c=void 0,r=function(n){n.classed("x3dAxisThreePlane",!0).selectAll("group").data(["xzAxis","yzAxis","yxAxis","zxAxis"]).enter().append("group").attr("class",function(n){return n});var e=l().scale(i).direction("x").tickDirection("z").tickSize(c.range()[1]-c.range()[0]).tickPadding(i.range()[0]).color("blue"),t=l().scale(o).direction("y").tickDirection("z").tickSize(c.range()[1]-c.range()[0]).color("red"),r=l().scale(o).direction("y").tickDirection("x").tickSize(i.range()[1]-i.range()[0]).tickFormat("").color("red"),a=l().scale(c).direction("z").tickDirection("x").tickSize(i.range()[1]-i.range()[0]).color("black");n.select(".xzAxis").call(e),n.select(".yzAxis").call(t),n.select(".yxAxis").call(r),n.select(".zxAxis").call(a)};return r.dimensions=function(n){return arguments.length?(e=n,this):e},r.xScale=function(n){return arguments.length?(i=n,r):i},r.yScale=function(n){return arguments.length?(o=n,r):o},r.zScale=function(n){return arguments.length?(c=n,r):c},r.colors=function(n){return arguments.length?(t=n,r):t},r},bars:x,barsMultiSeries:function(){var f={x:40,y:40,z:40},v=["orange","red","yellow","steelblue","green"],h=void 0,g=void 0,p=void 0,y=void 0,e=function(d){d.classed("x3dBarsMultiSeries",!0),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scaleBand().domain(r).rangeRound([0,o]).padding(.5)),void 0===g&&(g=j.scaleLinear().domain(a).range([0,c]).nice()),void 0===p&&(p=j.scaleBand().domain(t).range([0,l]).padding(.7)),void 0===y&&(y=j.scaleOrdinal().domain(r).range(v));var u=x().xScale(h).yScale(g).dimensions({x:f.x,y:f.y,z:p.bandwidth()}).colors(v),s=d.selectAll(".barGroup").data(n);s.enter().append("transform").classed("barGroup",!0).attr("translation",function(n){return"0 0 "+p(n.key)}).merge(s).transition().each(function(){j.select(this).call(u)}),s.exit().remove()})};return e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.colorScale=function(n){return arguments.length?(y=n,e):y},e.colors=function(n){return arguments.length?(v=n,e):v},e},bubbles:k,bubblesMultiSeries:function(){var g={x:40,y:40,z:40},p=["green","red","yellow","steelblue","orange"],y=void 0,x=void 0,m=void 0,S=void 0,z=void 0,b=[.5,3],e=function(h){h.classed("x3dBubblesMultiSeries",!0),h.each(function(n){var e,t,r,a,i,o,c,l,u,s,d;e=K(n).summary(),t=e.rowKeys,r=e.valueExtent,a=e.coordinatesMax,i=a.x,o=a.y,c=a.z,u=(l=g).x,s=l.y,d=l.z,void 0===y&&(y=j.scaleLinear().domain([0,i]).range([0,u])),void 0===x&&(x=j.scaleLinear().domain([0,o]).range([0,s])),void 0===m&&(m=j.scaleLinear().domain([0,c]).range([0,d])),void 0===S&&(S=j.scaleOrdinal().domain(t).range(p)),void 0===z&&(z=j.scaleLinear().domain(r).range(b));var f=k().xScale(y).yScale(x).zScale(m).sizeScale(z),v=h.selectAll(".bubbleGroup").data(n);v.enter().append("group").classed("bubbleGroup",!0).merge(v).transition().each(function(n){var e=S(n.key);f.color(e),j.select(this).call(f)}),v.exit().remove()})};return e.dimensions=function(n){return arguments.length?(g=n,this):g},e.xScale=function(n){return arguments.length?(y=n,e):y},e.yScale=function(n){return arguments.length?(x=n,e):x},e.zScale=function(n){return arguments.length?(m=n,e):m},e.colorScale=function(n){return arguments.length?(S=n,e):S},e.sizeScale=function(n){return arguments.length?(z=n,e):z},e.sizeDomain=function(n){return arguments.length?(b=n,e):b},e.colors=function(n){return arguments.length?(p=n,e):p},e},crosshair:function(){var g={x:40,y:40,z:40},p=["blue","red","green"],y=void 0,x=void 0,m=void 0,e=function(h){h.classed("x3dCrosshair",!0),h.each(function(n){var e=g.x/2,t=g.y/2,r=g.z/2,a=y(n.x),i=x(n.y),o=m(n.z),c={x:[e,i,o],y:[a,t,o],z:[a,i,r]};function l(n){return c[n].join(" ")}var u={x:[1,1,0,Math.PI],y:[0,0,0,0],z:[0,1,1,Math.PI]};function s(n){return u[n].join(" ")}var d=j.scaleOrdinal().domain(Object.keys(g)).range(p),f=h.selectAll(".line").data(Object.keys(g)),v=f.enter().append("transform").classed("line",!0).attr("translation",function(n){return l(n)}).attr("rotation",function(n){return s(n)}).append("shape");v.append("cylinder").attr("radius",.1).attr("height",function(n){return g[n]}),v.append("appearance").append("material").attr("diffusecolor",function(n){return d(n)}),f.transition().attr("translation",function(n){return l(n)}).attr("rotation",function(n){return s(n)})})};return e.dimensions=function(n){return arguments.length?(g=n,this):g},e.xScale=function(n){return arguments.length?(y=n,e):y},e.yScale=function(n){return arguments.length?(x=n,e):x},e.zScale=function(n){return arguments.length?(m=n,e):m},e.colors=function(n){return arguments.length?(p=n,e):p},e},ribbon:m,ribbonMultiSeries:function(){var f={x:40,y:40,z:40},v=["orange","red","yellow","steelblue","green"],h=void 0,g=void 0,p=void 0,y=void 0,e=function(d){d.classed("x3dRibbonMultiSeries",!0),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scalePoint().domain(r).range([0,o])),void 0===g&&(g=j.scaleLinear().domain(a).range([0,c])),void 0===p&&(p=j.scaleBand().domain(t).range([0,l]).padding(.4)),void 0===y&&(y=j.scaleOrdinal().domain(t).range(v));var u=m().xScale(h).yScale(g).dimensions({x:f.x,y:f.y,z:p.bandwidth()}),s=d.selectAll(".ribbonGroup").data(n);s.enter().append("transform").classed("ribbonGroup",!0).attr("translation",function(n){return"0 0 "+p(n.key)}).append("group").merge(s).transition().each(function(n){var e=y(n.key);u.color(e),j.select(this).call(u)}),s.exit().remove()})};return e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.colorScale=function(n){return arguments.length?(y=n,e):y},e.colors=function(n){return arguments.length?(v=n,e):v},e},surface:function(){var S={x:40,y:40,z:40},z=["blue","red"],b=void 0,k=void 0,w=void 0,L=void 0,A=function(n){return n.reduce(function(n,e){return n.concat(e)},[]).reduce(function(n,e){return n.concat(e)},[]).join(" ")},e=function(m){m.classed("x3dSurface",!0),m.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=S).x,c=i.y,l=i.z,void 0===b&&(b=j.scalePoint().domain(t).range([0,o])),void 0===k&&(k=j.scaleLinear().domain(a).range([0,c])),void 0===w&&(w=j.scalePoint().domain(r).range([0,l])),void 0===L&&(L=j.scaleLinear().domain(a).range(z).interpolate(j.interpolateLab));var u=n.length,s=n[0].values.length,d=function(n){var e=n.map(function(e){return e.values.map(function(n){return[b(e.key),k(n.value),w(n.key)]})});return A(e)},f=function(n){var e=n.map(function(n){return n.values.map(function(n){var e=j.color(L(n.value));return Math.round(e.r/2.55)/100+" "+Math.round(e.g/2.55)/100+" "+Math.round(e.b/2.55)/100})});return A(e)},v=Array.apply(0,Array(u-1)).map(function(n,r){return Array.apply(0,Array(s-1)).map(function(n,e){var t=e+r*s;return[t,t+s,t+s+1,t+1,t,-1]})}),h=Array.apply(0,Array(u-1)).map(function(n,r){return Array.apply(0,Array(s-1)).map(function(n,e){var t=e+r*s;return[t,t+1,t+s+1,t+s,t,-1]})}),g=A(v.concat(h)),p=m.selectAll(".surface").data(function(n){return[n]}),y=p.enter().append("shape").classed("surface",!0).append("indexedfaceset").attr("coordindex",g);y.append("coordinate").attr("point",d),y.append("color").attr("color",f),y.merge(p);var x=p.transition().select("indexedfaceset").attr("coordindex",g);x.select("coordinate").attr("point",d),x.select("color").attr("color",f),p.exit().remove()})};return e.dimensions=function(n){return arguments.length?(S=n,this):S},e.xScale=function(n){return arguments.length?(b=n,e):b},e.yScale=function(n){return arguments.length?(k=n,e):k},e.zScale=function(n){return arguments.length?(w=n,e):w},e.colorScale=function(n){return arguments.length?(L=n,e):L},e.colors=function(n){return arguments.length?(z=n,e):z},e},vectorFields:function(){var z={x:40,y:40,z:40},b=j.interpolateRdYlGn,k=void 0,w=void 0,L=void 0,A=void 0,M=void 0,P=[2,7],O=function(n,e,t){return{x:n,y:e,z:t}},e=function(S){S.classed("x3dVectorFields",!0),S.each(function(n){var e,t,r,a,i,o,c,l,u,s,d,f,v,h,g;t=K(e=n).summary(),r=t.coordinatesMax,a=t.coordinatesMin,i=a.x,o=a.y,c=a.z,l=r.x,u=r.y,s=r.z,f=(d=z).x,v=d.y,h=d.z,g=j.extent(e.values.map(function(n){var e=void 0,t=void 0,r=void 0;if("vx"in n)e=n.vx,t=n.vy,r=n.vz;else{var a=O(n.x,n.y,n.z);e=a.x,t=a.y,r=a.z}return new x3dom.fields.SFVec3f(e,t,r).length()})),void 0===k&&(k=j.scaleLinear().domain([i,l]).range([0,f])),void 0===w&&(w=j.scaleLinear().domain([o,u]).range([0,v])),void 0===L&&(L=j.scaleLinear().domain([c,s]).range([0,h])),void 0===A&&(A=j.scaleSequential().domain(g.slice().reverse()).interpolator(b)),void 0===M&&(M=j.scaleLinear().domain(g).range(P));var p=S.selectAll(".arrow").data(function(n){return n.values.map(function(n){var e=void 0,t=void 0,r=void 0;if("vx"in n)e=n.vx,t=n.vy,r=n.vz;else{var a=O(n.x,n.y,n.z);e=a.x,t=a.y,r=a.z}var i=new x3dom.fields.SFVec3f(0,1,0),o=new x3dom.fields.SFVec3f(e,t,r),c=x3dom.fields.Quaternion.rotateFromTo(i,o).toAxisAngle();return n.translation=k(n.x)+" "+w(n.y)+" "+L(n.z),n.value=o.length(),n.rotation=c[0].x+" "+c[0].y+" "+c[0].z+" "+c[1],n})}),y=p.enter().append("transform").attr("class","arrow").attr("translation",function(n){return n.translation}).attr("rotation",function(n){return n.rotation}).append("transform").attr("translation",function(n){return"0 "+M(n.value)/2+" 0"}),x=y.append("shape");x.append("appearance").append("material").attr("diffusecolor",function(n){return E(A(n.value))}),x.append("cylinder").attr("height",function(n){return M(n.value)}).attr("radius",.1);var m=y.append("transform").attr("translation",function(n){return"0 "+M(n.value)/2+" 0"}).append("shape");m.append("appearance").append("material").attr("diffusecolor",function(n){return E(A(n.value))}),m.append("cone").attr("height",1).attr("bottomradius",.4),y.merge(p),p.transition().attr("translation",function(n){return n.translation}),p.exit().remove()})},E=function(n){return(n=n.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===n.length?"#"+("0"+parseInt(n[1],10).toString(16)).slice(-2)+("0"+parseInt(n[2],10).toString(16)).slice(-2)+("0"+parseInt(n[3],10).toString(16)).slice(-2):""};return e.dimensions=function(n){return arguments.length?(z=n,this):z},e.xScale=function(n){return arguments.length?(k=n,e):k},e.yScale=function(n){return arguments.length?(w=n,e):w},e.zScale=function(n){return arguments.length?(L=n,e):L},e.colorScale=function(n){return arguments.length?(A=n,e):A},e.colors=function(n){return arguments.length?(b=n,e):b},e.sizeScale=function(n){return arguments.length?(M=n,e):M},e.sizeDomain=function(n){return arguments.length?(P=n,e):P},e.vectorFunction=function(n){return arguments.length?(O=n,e):O},e},viewpoint:function(){var e=[0,0,0],t=[80,15,80],r=[0,1,0,.8],a=.8,i=function(n){n.append("viewpoint").classed("x3dViewpoint",!0).attr("centerofrotation",e.join(" ")).attr("position",t.join(" ")).attr("orientation",r.join(" ")).attr("fieldofview",a).attr("set_bind","true")};return i.quickView=function(n){switch(n){case"left":e=[0,0,0],t=[37.10119,18.70484,51.01594],r=[.06724,.99767,-.01148,.33908],a=1;break;case"side":e=[20,0,0],t=[20,20,50],r=[0,0,0,0],a=1;break;case"top":e=[0,0,0],t=[27.12955,106.67181,31.65828],r=[-.86241,.3749,.34013,1.60141],a=1;break;case"dimetric":default:e=[0,0,0],t=[80,15,80],r=[0,1,0,.8],a=.8}return i},i.centerOfRotation=function(n){return arguments.length?(e=n,i):e},i.viewPosition=function(n){return arguments.length?(t=n,i):t},i.viewOrientation=function(n){return arguments.length?(r=n,i):r},i.fieldOfView=function(n){return arguments.length?(a=n,i):a},i}};var n={barChartMultiSeries:function(){var r=500,a=500,f={x:40,y:40,z:40},v=["green","red","yellow","steelblue","orange"],i=!1,h=void 0,g=void 0,p=void 0,y=void 0,e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var d=e.append("scene");d.classed("x3dBarChartMultiSeries",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([f.x/2,f.y/2,f.z/2]);d.call(t),d.append("directionallight").attr("direction","1 0 -1").attr("on","true").attr("intensity","0.4").attr("shadowintensity","0"),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scaleBand().domain(r).rangeRound([0,o]).padding(.5)),void 0===g&&(g=j.scaleLinear().domain(a).range([0,c]).nice()),void 0===p&&(p=j.scaleBand().domain(t).range([0,l]).padding(.7)),void 0===y&&(y=j.scaleOrdinal().domain(r).range(v));var u=O.axisThreePlane().xScale(h).yScale(g).zScale(p),s=O.barsMultiSeries().xScale(h).yScale(g).zScale(p).colors(v);d.select(".axis").call(u),d.select(".chart").datum(n).call(s)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.colorScale=function(n){return arguments.length?(y=n,e):y},e.colors=function(n){return arguments.length?(v=n,e):v},e.debug=function(n){return arguments.length?(i=n,e):i},e},barChartVertical:function(){var r=500,a=500,d={x:40,y:40,z:40},f=["green","red","yellow","steelblue","orange"],i=!1,v=void 0,h=void 0,g=void 0,e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var s=e.append("scene");s.classed("x3dBarChartVertical",!0).selectAll("group").data(["xAxis","yAxis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().quickView("left");s.call(t),s.each(function(n){var e,t,r,a,i,o;e=K(n).summary(),t=e.columnKeys,r=[0,e.valueMax],i=(a=d).x,o=a.y,void 0===v&&(v=j.scaleBand().domain(t).rangeRound([0,i]).padding(.5)),void 0===h&&(h=j.scaleLinear().domain(r).range([0,o]).nice()),void 0===g&&(g=j.scaleOrdinal().domain(t).range(f));var c=O.axis().scale(v).direction("x").tickDirection("y"),l=O.axis().scale(h).direction("y").tickDirection("x").tickSize(h.range()[1]-h.range()[0]),u=O.bars().xScale(v).yScale(h).colors(f);s.select(".xAxis").call(c),s.select(".yAxis").call(l),s.select(".chart").datum(n).call(u)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(d=n,this):d},e.xScale=function(n){return arguments.length?(v=n,e):v},e.yScale=function(n){return arguments.length?(h=n,e):h},e.colorScale=function(n){return arguments.length?(g=n,e):g},e.colors=function(n){return arguments.length?(f=n,e):f},e.debug=function(n){return arguments.length?(i=n,e):i},e},bubbleChart:function(){var r=500,a=500,g={x:40,y:40,z:40},p=["green","red","yellow","steelblue","orange"],i=!1,y=void 0,x=void 0,m=void 0,S=void 0,z=void 0,b=[.5,3.5],e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var h=e.append("scene");h.classed("x3dBubbleChart",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([g.x/2,g.y/2,g.z/2]);h.call(t),h.append("directionallight").attr("direction","1 0 -1").attr("on","true").attr("intensity","0.4").attr("shadowintensity","0"),h.each(function(n){var e,t,r,a,i,o,c,l,u,s,d;e=K(n).summary(),t=e.valueExtent,r=e.coordinatesMax,a=e.rowKeys,i=r.x,o=r.y,c=r.z,u=(l=g).x,s=l.y,d=l.z,void 0===y&&(y=j.scaleLinear().domain([0,i]).range([0,u])),void 0===x&&(x=j.scaleLinear().domain([0,o]).range([0,s])),void 0===m&&(m=j.scaleLinear().domain([0,c]).range([0,d])),void 0===S&&(S=j.scaleOrdinal().domain(a).range(p)),void 0===z&&(z=j.scaleLinear().domain(t).range(b));var f=O.axisThreePlane().xScale(y).yScale(x).zScale(m),v=O.bubblesMultiSeries().xScale(y).yScale(x).zScale(m).sizeScale(z).colorScale(S);h.select(".axis").call(f),h.select(".chart").datum(n).call(v)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(g=n,this):g},e.xScale=function(n){return arguments.length?(y=n,e):y},e.yScale=function(n){return arguments.length?(x=n,e):x},e.zScale=function(n){return arguments.length?(m=n,e):m},e.colorScale=function(n){return arguments.length?(S=n,e):S},e.colors=function(n){return arguments.length?(p=n,e):p},e.sizeScale=function(n){return arguments.length?(z=n,e):z},e.sizeDomain=function(n){return arguments.length?(b=n,e):b},e.debug=function(n){return arguments.length?(i=n,e):i},e},ribbonChartMultiSeries:function(){var r=500,a=500,f={x:60,y:40,z:40},v=["green","red","yellow","steelblue","orange"],i=!1,h=void 0,g=void 0,p=void 0,y=void 0,e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var d=e.append("scene");d.classed("x3dRibbonChartMultiSeries",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([f.x/2,f.y/2,f.z/2]).viewOrientation([-.61021,.77568,.16115,.65629]).viewPosition([77.63865,54.6947,104.38314]);d.call(t),d.append("directionallight").attr("direction","1 0 -1").attr("on","true").attr("intensity","0.4").attr("shadowintensity","0"),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scalePoint().domain(r).range([0,o])),void 0===g&&(g=j.scaleLinear().domain(a).range([0,c]).nice()),void 0===p&&(p=j.scaleBand().domain(t).range([0,l]).padding(.4)),void 0===y&&(y=j.scaleOrdinal().domain(r).range(v));var u=O.axisThreePlane().xScale(h).yScale(g).zScale(p),s=O.ribbonMultiSeries().xScale(h).yScale(g).zScale(p).colors(v);d.select(".axis").call(u),d.select(".chart").datum(n).call(s)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.colorScale=function(n){return arguments.length?(y=n,e):y},e.colors=function(n){return arguments.length?(v=n,e):v},e.debug=function(n){return arguments.length?(i=n,e):i},e},scatterPlot:function(){var r=500,a=500,f={x:40,y:40,z:40},v="orange",i=!1,h=void 0,g=void 0,p=void 0,e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var d=e.append("scene");d.classed("x3dScatterPlot",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([f.x/2,f.y/2,f.z/2]);d.call(t),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary().coordinatesMax,t=e.x,r=e.y,a=e.z,o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scaleLinear().domain([0,t]).range([0,o])),void 0===g&&(g=j.scaleLinear().domain([0,r]).range([0,c])),void 0===p&&(p=j.scaleLinear().domain([0,a]).range([0,l]));var u=O.axisThreePlane().xScale(h).yScale(g).zScale(p),s=O.bubbles().xScale(h).yScale(g).zScale(p).color(v).sizeDomain([.5,.5]);d.select(".axis").call(u),d.select(".chart").datum(n).call(s)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.color=function(n){return arguments.length?(v=n,e):v},e.debug=function(n){return arguments.length?(i=n,e):i},e},surfacePlot:function(){var r=500,a=500,f={x:40,y:40,z:40},v=["blue","red"],i=!1,h=void 0,g=void 0,p=void 0,y=void 0,e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var d=e.append("scene");d.classed("x3dSurfacePlot",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([f.x/2,f.y/2,f.z/2]);d.call(t),d.each(function(n){var e,t,r,a,i,o,c,l;e=K(n).summary(),t=e.rowKeys,r=e.columnKeys,a=[0,e.valueMax],o=(i=f).x,c=i.y,l=i.z,void 0===h&&(h=j.scalePoint().domain(t).range([0,o])),void 0===g&&(g=j.scaleLinear().domain(a).range([0,c]).nice()),void 0===p&&(p=j.scalePoint().domain(r).range([0,l])),void 0===y&&(y=j.scaleLinear().domain(a).range(v).interpolate(j.interpolateLab));var u=O.axisThreePlane().xScale(h).yScale(g).zScale(p),s=O.surface().xScale(h).yScale(g).zScale(p).colors(v);d.select(".axis").call(u),d.select(".chart").datum(n).call(s)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(f=n,this):f},e.xScale=function(n){return arguments.length?(h=n,e):h},e.yScale=function(n){return arguments.length?(g=n,e):g},e.zScale=function(n){return arguments.length?(p=n,e):p},e.colorScale=function(n){return arguments.length?(y=n,e):y},e.colors=function(n){return arguments.length?(v=n,e):v},e.debug=function(n){return arguments.length?(i=n,e):i},e},vectorFieldChart:function(){var r=500,a=500,m={x:40,y:40,z:40},S=j.interpolateRdYlGn,i=!1,z=void 0,b=void 0,k=void 0,w=void 0,L=void 0,A=[2,7],M={x:0,y:0,z:0},P=function(n,e,t){return{x:n,y:e,z:t}},e=function(n){var e=n.append("x3d").attr("width",r+"px").attr("height",a+"px");i&&e.attr("showLog","true").attr("showStat","true");var x=e.append("scene");x.classed("x3dVectorFieldChart",!0).selectAll("group").data(["axis","chart"]).enter().append("group").attr("class",function(n){return n});var t=O.viewpoint().centerOfRotation([m.x/2,m.y/2,m.z/2]);x.call(t),x.each(function(n){var e,t,r,a,i,o,c,l,u,s,d,f,v,h,g;t=K(e=n).summary(),r=t.coordinatesMax,a=t.coordinatesMin,i=a.x,o=a.y,c=a.z,l=r.x,u=r.y,s=r.z,f=(d=m).x,v=d.y,h=d.z,g=j.extent(e.values.map(function(n){var e=void 0,t=void 0,r=void 0;if("vx"in n)e=n.vx,t=n.vy,r=n.vz;else{var a=P(n.x,n.y,n.z);e=a.x,t=a.y,r=a.z}return new x3dom.fields.SFVec3f(e,t,r).length()})),void 0===z&&(z=j.scaleLinear().domain([i,l]).range([0,f])),void 0===b&&(b=j.scaleLinear().domain([o,u]).range([0,v])),void 0===k&&(k=j.scaleLinear().domain([c,s]).range([0,h])),void 0===w&&(w=j.scaleSequential().domain(g.slice().reverse()).interpolator(S)),void 0===L&&(L=j.scaleLinear().domain(g).range(A));var p=O.crosshair().xScale(z).yScale(b).zScale(k),y=O.vectorFields().xScale(z).yScale(b).zScale(k).colorScale(w).sizeScale(L).vectorFunction(P);x.select(".axis").datum(M).call(p),x.select(".chart").datum(n).call(y)})};return e.width=function(n){return arguments.length?(r=n,this):r},e.height=function(n){return arguments.length?(a=n,this):a},e.dimensions=function(n){return arguments.length?(m=n,this):m},e.xScale=function(n){return arguments.length?(z=n,e):z},e.yScale=function(n){return arguments.length?(b=n,e):b},e.zScale=function(n){return arguments.length?(k=n,e):k},e.colorScale=function(n){return arguments.length?(w=n,e):w},e.colors=function(n){return arguments.length?(S=n,e):S},e.debug=function(n){return arguments.length?(i=n,e):i},e.vectorFunction=function(n){return arguments.length?(P=n,e):P},e}},e=["UK","France","Spain","Germany","Italy","Portugal"],t=["Apples","Oranges","Pears","Bananas"];function r(){return Math.floor(10*Math.random())+1}var a=Object.freeze({countries:e,fruit:t,randomNum:r,dataset1:function(){return{key:"Fruit",values:t.map(function(n){return{key:n,value:r(),x:r(),y:r(),z:r()}})}},dataset2:function(){return e.map(function(n){return{key:n,values:t.map(function(n){return{key:n,value:r(),x:r(),y:r(),z:r()}})}})},dataset3:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;return{key:"Bubbles",values:j.range(n).map(function(n,e){return{key:"Point"+e,value:r(),x:r(),y:r(),z:r()}})}},dataset4:function(){return[{key:"a",values:[{key:"1",value:4},{key:"2",value:0},{key:"3",value:2},{key:"4",value:0},{key:"5",value:0}]},{key:"b",values:[{key:"1",value:4},{key:"2",value:0},{key:"3",value:2},{key:"4",value:0},{key:"5",value:0}]},{key:"c",values:[{key:"1",value:1},{key:"2",value:0},{key:"3",value:1},{key:"4",value:0},{key:"5",value:0}]},{key:"d",values:[{key:"1",value:4},{key:"2",value:0},{key:"3",value:2},{key:"4",value:0},{key:"5",value:0}]},{key:"e",values:[{key:"1",value:1},{key:"2",value:1},{key:"3",value:1},{key:"4",value:1},{key:"5",value:1}]}]},dataset5:function(){var a=j.range(0,1.05,.1),i=j.range(0,1.05,.1),n=a.length,e=i.length;return j.range(n).map(function(r){var n=j.range(e).map(function(n){return{key:n,value:(e=a[r],t=i[n],((e-.8)*(e-.8)+(t-.3)*(e-.8))*Math.random())};var e,t});return{key:r,values:n}})}}),i="James Saunders";return{version:"1.0.22",author:i,copyright:"Copyright (C) "+(new Date).getFullYear()+" "+i,license:"GPL-2.0",chart:n,component:O,dataTransform:K,randomData:a}});
